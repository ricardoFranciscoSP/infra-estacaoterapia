FROM redis:7-alpine

# Instalar dos2unix para garantir line endings corretos
RUN apk add --no-cache dos2unix

# Copiar script de entrypoint customizado
COPY redis-entrypoint.sh /usr/local/bin/redis-entrypoint.sh

# Garantir line endings Unix e permiss√µes corretas
RUN dos2unix /usr/local/bin/redis-entrypoint.sh && \
    chmod +x /usr/local/bin/redis-entrypoint.sh && \
    apk del dos2unix

# Usar o entrypoint customizado
ENTRYPOINT ["/usr/local/bin/redis-entrypoint.sh"]
